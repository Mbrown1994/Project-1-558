---
title: "Project 1 558"
author: "Mary Brown"
date: "10/4/2021"
output:  
  rmarkdown::github_document
---

# This code chunk connects to the COVID API and converts the summary information to text, then to json, and lastly to a data frame. 
```{r,echo=TRUE, message=FALSE}  
library(httr)  
library(jsonlite)  
Data<-GET("https://api.covid19api.com/summary")  
get_text<-(content(Data,"text"))  
get_json<-fromJSON(get_text, flatten=TRUE)  
get_df<-as.data.frame(get_json)  
```  

# This function returns the number of cases of either confirmed cases, active cases, deaths, or recovered cases (user specified) for the United States  
```{r,echo=TRUE, message=FALSE}  
library(magrittr)  
library(dplyr)  
USAdata<-function(type="all"){  
  outputAPI<-GET("https://api.covid19api.com/total/country/united-states")  
  data<-fromJSON(rawToChar(outputAPI$content))
  if(type !="all"){  
    data<-data %>% select(type)
  }  
  return(data)
    }  
```  

# This function returns user specified type by a user specified country in North America (united-states or canada)
```{r,echo=FALSE}  
NorthAmerica<-function(type="all", Country="all"){  
  outputAPI<-GET("https://api.covid19api.com/total/country/united-states")  
  data<-fromJSON(rawToChar(outputAPI$content))  
  if (type %in% c("Deaths", "Recovered", "Active", "Confirmed", "Date", "Country")){  
    if (Country == "canada"){  
      baseurl <- "https://api.covid19api.com/total/country/"  
      fullURL <- paste0(baseurl, Country)  
      data <- fromJSON(fullURL)  
      data <- data %>% select(type)  
    }  
    else if (Country == "united-states"){  
      baseurl <- "https://api.covid19api.com/total/country/"  
      fullURL <- paste0(baseurl, Country)  
      data <- fromJSON(fullURL)  
      data <- data %>% select(type)  
    }  
  }  
  else {  
    stop("Error: please specify either united-states or canada or a valid type")  
  }  
  return(data)  
}  
```

